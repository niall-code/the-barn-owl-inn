{% extends "base.html" %}
{% load static %}
{% block content %}

  {% if user.is_authenticated %}

    <h2>My Existing Reservations</h2>

    {% for reservation in reservations %}
      {% if reservation.reserver == user %}

        <div>

          <p id="date{{ reservation.id }}">{{ reservation.date|date:"Y-m-d" }}</p>
          <p id="time{{ reservation.id }}">{{ reservation.start_time|time:"H:i" }}</p>
          <p id="length{{ reservation.id }}">{{ reservation.duration }}</p>
          {% for table in reservation.tables.all %}
            <p class="table-for-{{ reservation.id }}">{{ table.number }}</p>
          {% endfor %}
          <p id="contact{{ reservation.id }}">{{ reservation.contact }}</p>

        </div>

        <button class="edit" data-reservation_id="{{ reservation.id }}">Edit</button>
        <button class="delete" data-reservation_id="{{ reservation.id }}">Delete</button>

      {% endif %}
    {% endfor %}

    <h2>Create a New Reservation</h2>

    <form method="post" action="" id="reservationForm">

      <div id="tables-map-positioner">
        <div id="tables-map">
          {% for table in tables %}
            <button type="button" id="table-{{ table.number }}" class="seats-{{ table.seats }} table">
              Table {{ table.number }} <br> (seats <b>{{ table.seats }}</b>)
            </button>
          {% endfor %}
        </div>

        {{ reservation_form.as_p }}
        {% csrf_token %}
      </div>

      <button type="submit" id="submitButton">Submit</button>

    </form>

  {% else %}

    <p>
      To make a new reservation or view/edit an existing reservation, please 
      <a href="{{ signup_url }}">sign up</a> or 
      <a href="{{ login_url }}">log in</a> first.
    </p>

  {% endif %}

{% endblock %}

{% block script %}
  <script src="{% static 'js/table_select.js' %}"></script>
  <script src="{% static 'js/edit_reservation.js' %}"></script>
{% endblock %}